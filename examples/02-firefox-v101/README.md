This example uses a map file to sign the Nightly.app bundle in a way that
results in a similar codesign compared to how Firefox is signed today in
automation (as of April 2022).

```
$ git clone https://github.com/hafta/codesign-tree.git
$ cd codesign-tree
```

Copy an installation of Nightly from /Applications or create a .app from a
mozilla-central repo with `./mach build package' and use the Nightly.app from
the .dmg file generated by the build.
```
$ ditto /Applications/Firefox\ Nightly.app Nightly.app
```

Clear extended attributes before signing.
```
$ xattr -c -r Nightly.app
```

Store your code signing identity in the CSID environment variable. This is the
same value passed to the codesign command -s option.
```
$ export CSID=<Your developer ID codesigning identity>
```

Run codesign-tree which will sign files as dictated by the codesign-map.json file.
```
$ python3 codesign-tree.py -v -m ./examples/02-firefox-v101/production.codesign-map.json -r ./Nightly.app/ -d ./examples/02-firefox-v101/ -s $CSID
$ python3 codesigntree.py -v -m ./examples/02-firefox-v101/production.codesign-map.json -r ./Nightly.app/ -d ./examples/02-firefox-v101/ -s $CSID
INFO:codesign:JSON map file:          /codesign-tree/examples/02-firefox-v101/production.codesign-map.json
INFO:codesign:Entitlement directory:  /codesign-tree/examples/02-firefox-v101
INFO:codesign:Root directory:         /codesign-tree/Nightly.app
INFO:codesign:Codesigning identity:   XXXXXXXXXX
INFO:codesign:Override:               sign: XXXXXXXXXX
DEBUG:codesign:json map file: /codesign-tree/examples/02-firefox-v101/production.codesign-map.json
DEBUG:codesign:entitlement directory: /codesign-tree/examples/02-firefox-v101
DEBUG:codesign:root directory: /codesign-tree/Nightly.app
DEBUG:codesign:codesign command to use: /usr/bin/codesign
DEBUG:codesign:override: sign: XXXXXXXXXX
INFO:codesign:/usr/bin/codesign -v --force --sign D --options runtime --entitlements /codesign-tree/examples/02-firefox-v101/production.entitlements.xml /codesign-tree/Nightly.app/Contents/MacOS/crashreporter.app /codesign-tree/Nightly.app/Contents/MacOS/updater.app /codesign-tree/Nightly.app/Contents/Library/LaunchServices/org.mozilla.updater /codesign-tree/Nightly.app/Contents/MacOS/plugin-container.app /codesign-tree/Nightly.app/Contents/MacOS/XUL /codesign-tree/Nightly.app/Contents/MacOS/pingsender /codesign-tree/Nightly.app/Contents/MacOS/minidump-analyzer /codesign-tree/Nightly.app/Contents/MacOS/libfreebl3.dylib /codesign-tree/Nightly.app/Contents/MacOS/liblgpllibs.dylib /codesign-tree/Nightly.app/Contents/MacOS/libsoftokn3.dylib /codesign-tree/Nightly.app/Contents/MacOS/libosclientcerts.dylib /codesign-tree/Nightly.app/Contents/MacOS/libmozavutil.dylib /codesign-tree/Nightly.app/Contents/MacOS/libmozglue.dylib /codesign-tree/Nightly.app/Contents/MacOS/libipcclientcerts.dylib /codesign-tree/Nightly.app/Contents/MacOS/libmozavcodec.dylib /codesign-tree/Nightly.app/Contents/MacOS/libnssckbi.dylib /codesign-tree/Nightly.app/Contents/MacOS/libnss3.dylib /codesign-tree/Nightly.app/Contents/MacOS/firefox-bin /codesign-tree/Nightly.app/Contents/Resources/gmp-clearkey/0.1/libclearkey.dylib /codesign-tree/Nightly.app/
/codesign-tree/Nightly.app/Contents/MacOS/crashreporter.app: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/crashreporter.app: signed app bundle with Mach-O universal (x86_64 arm64) [org.mozilla.crashreporter]
/codesign-tree/Nightly.app/Contents/MacOS/updater.app: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/updater.app: signed app bundle with Mach-O universal (x86_64 arm64) [org.mozilla.updater]
/codesign-tree/Nightly.app/Contents/Library/LaunchServices/org.mozilla.updater: replacing existing signature
/codesign-tree/Nightly.app/Contents/Library/LaunchServices/org.mozilla.updater: signed Mach-O universal (x86_64 arm64) [org.mozilla.updater]
/codesign-tree/Nightly.app/Contents/MacOS/plugin-container.app: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/plugin-container.app: signed app bundle with Mach-O universal (x86_64 arm64) [org.mozilla.plugincontainer]
/codesign-tree/Nightly.app/Contents/MacOS/XUL: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/XUL: signed Mach-O universal (x86_64 arm64) [XUL]
/codesign-tree/Nightly.app/Contents/MacOS/pingsender: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/pingsender: signed Mach-O universal (x86_64 arm64) [pingsender]
/codesign-tree/Nightly.app/Contents/MacOS/minidump-analyzer: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/minidump-analyzer: signed Mach-O universal (x86_64 arm64) [minidump-analyzer]
/codesign-tree/Nightly.app/Contents/MacOS/libfreebl3.dylib: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/libfreebl3.dylib: signed Mach-O universal (x86_64 arm64) [libfreebl3]
/codesign-tree/Nightly.app/Contents/MacOS/liblgpllibs.dylib: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/liblgpllibs.dylib: signed Mach-O universal (x86_64 arm64) [liblgpllibs]
/codesign-tree/Nightly.app/Contents/MacOS/libsoftokn3.dylib: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/libsoftokn3.dylib: signed Mach-O universal (x86_64 arm64) [libsoftokn3]
/codesign-tree/Nightly.app/Contents/MacOS/libosclientcerts.dylib: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/libosclientcerts.dylib: signed Mach-O universal (x86_64 arm64) [libosclientcerts]
/codesign-tree/Nightly.app/Contents/MacOS/libmozavutil.dylib: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/libmozavutil.dylib: signed Mach-O universal (x86_64 arm64) [libmozavutil]
/codesign-tree/Nightly.app/Contents/MacOS/libmozglue.dylib: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/libmozglue.dylib: signed Mach-O universal (x86_64 arm64) [libmozglue]
/codesign-tree/Nightly.app/Contents/MacOS/libipcclientcerts.dylib: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/libipcclientcerts.dylib: signed Mach-O universal (x86_64 arm64) [libipcclientcerts]
/codesign-tree/Nightly.app/Contents/MacOS/libmozavcodec.dylib: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/libmozavcodec.dylib: signed Mach-O universal (x86_64 arm64) [libmozavcodec]
/codesign-tree/Nightly.app/Contents/MacOS/libnssckbi.dylib: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/libnssckbi.dylib: signed Mach-O universal (x86_64 arm64) [libnssckbi]
/codesign-tree/Nightly.app/Contents/MacOS/libnss3.dylib: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/libnss3.dylib: signed Mach-O universal (x86_64 arm64) [libnss3]
/codesign-tree/Nightly.app/Contents/MacOS/firefox-bin: replacing existing signature
/codesign-tree/Nightly.app/Contents/MacOS/firefox-bin: signed Mach-O universal (x86_64 arm64) [firefox-bin]
/codesign-tree/Nightly.app/Contents/Resources/gmp-clearkey/0.1/libclearkey.dylib: replacing existing signature
/codesign-tree/Nightly.app/Contents/Resources/gmp-clearkey/0.1/libclearkey.dylib: signed Mach-O universal (x86_64 arm64) [libclearkey]
/codesign-tree/Nightly.app/: replacing existing signature
/codesign-tree/Nightly.app/: signed app bundle with Mach-O universal (x86_64 arm64) [org.mozilla.nightly]
